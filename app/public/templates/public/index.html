{% extends "base_template.html" %}
{% block title %}
INSPRE | Sistema de gestión
{% endblock %}
{% block content %}
<div class="container mt-4">


  {% for nodo in nodos_x_tipo_vehiculo.items %}
  <h1>Nodo: {{ nodo.nombre }}</h1>
  <h2>Tomar y subir foto</h2>
  
  <!-- Botón para iniciar cámara -->
  <div id="inicioContainer" class="text-center" style="margin: 40px 0;">
    <button id="iniciarCamara" class="btn btn-primary btn-lg">📷 Abrir cámara</button>
  </div>
  
  <!-- Vista previa cámara (oculta al inicio) -->
  <div id="videoContainer" style="position: relative; max-width: 100%; display: none;">
    <video id="video" autoplay playsinline style="width:100%; max-width:600px; border:2px solid #333; border-radius:8px; display:block;"></video>
    
    <!-- Overlay con imagen SVG -->
    {% if overlay_svg_url %}
    <div id="overlay" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;">
      <img src="{{ overlay_svg_url }}" alt="" style="width: 100%; height: 100%; object-fit: contain;">
    </div>
    {% endif %}
  </div>
  
  <!-- Botones de control (ocultos al inicio) -->
  <div id="controlesContainer" class="mt-3" style="display: none;">
    <button id="cambiarCamara" class="btn btn-secondary" disabled>🔄 Cambiar cámara</button>
    <button id="capturar" class="btn btn-primary" disabled>📸 Capturar</button>
  </div>
  
  <!-- Canvas oculto para procesar -->
  <canvas id="canvas" style="display:none;"></canvas>
  
  <!-- Preview después de capturar -->
  <div id="previewContainer" style="display:none; margin-top:20px;">
    <h5>Vista previa:</h5>
    <img id="preview" style="max-width:100%; max-height:400px; border:1px solid #ccc; border-radius:8px;">
    <div class="mt-2">
      <button id="rehacer" class="btn btn-warning">🔄 Tomar otra</button>
    </div>
  </div>
  
  <!-- Formulario para enviar -->
  <form id="form" method="POST" enctype="multipart/form-data" style="margin-top:20px; display:none;">
    {{ form.hidden_tag() if form }}
    <button type="submit" class="btn btn-success btn-lg">⬆️ Subir al servidor</button>
  </form>
  
  <!-- Estado por ahora no lo quiero mostrar-->
  <!-- <div id="status" style="margin-top:15px; padding:10px; border-radius:5px;"></div> -->
</div>
  {% endfor %}



<nav aria-label="Page navigation example">
	<ul class="pagination justify-content-center">
            <!-- <li class="page-item disabled">
                <a class="page-link" href="#">Anterior</a>
            </li> -->
        {%- for page in nodos_x_tipo_vehiculo.iter_pages() %}
			{% if page %}

				{% if page != nodos_x_tipo_vehiculo.page %}
            
					<li class="page-item"><a class="page-link" href="{{ url_for('public.index', solicitud=solicitud,tipo_vehiculo=tipo_vehiculo ,page=page) }}">{{ page }}</a>
				{% else %}
					<li class="page-item active">
						<span class="page-link">
							{{ page }}
							<span class="sr-only"></span>
						</span>
					</li>
                {% endif %}
			{% endif %}
		{%- endfor %}
        <!-- <li class="page-item">
            <a class="page-link" href="#">Siguiente</a>
        </li> -->
	</ul>
</nav>
  
  
  
  
  
  
  
  
  
  

{% endblock %}